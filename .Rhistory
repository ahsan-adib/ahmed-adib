)
exped.data |>
mutate(accident = !is.na(ACCIDENTS)) |>
group_by(COMRTE, STDRTE) |>
summarise(
accident_rate = (mean(accident, na.rm = TRUE))*100,
total = n()
)
exped.data |>
mutate(accident = !is.na(ACCIDENTS)) |>
group_by(COMRTE, STDRTE) |>
summarise(
accident_rate = scales::percent(mean(accident, na.rm = TRUE)),
total = n()
)
exped.data %>%
count(TERMREASON_FACTOR, sort = TRUE)
exped.data |> count(TERMREASON_FACTOR, sort=TRUE)
exped.data |> count(TERMREASON_FACTOR, sort=TRUE) |>
ggplot(aes(x = TERMREASON_FACTOR, y = n(), fill = TERMREASON_FACTOR)) |>
coord_flip()
exped.data |> count(TERMREASON_FACTOR, sort=TRUE) |>
ggplot(aes(x = TERMREASON_FACTOR, y = n(), fill = TERMREASON_FACTOR))
exped.data |> count(TERMREASON_FACTOR, sort=TRUE) |>
ggplot(aes(x = TERMREASON_FACTOR, y = n, fill = TERMREASON_FACTOR)) |>
coord_flip()
exped.data |> count(TERMREASON_FACTOR, sort=TRUE) |>
ggplot(aes(x = TERMREASON_FACTOR, y = n, fill = TERMREASON_FACTOR))
exped.data |> count(TERMREASON_FACTOR, sort=TRUE) |>
ggplot(aes(x = TERMREASON_FACTOR, y = n, fill = n))
exped.data |> count(TERMREASON_FACTOR, sort=TRUE) |>
ggplot(aes(x = TERMREASON_FACTOR, y = n, fill = n)) |>
coord_flip()
exped.data |> count(TERMREASON_FACTOR, sort=TRUE) |>
ggplot(aes(x = TERMREASON_FACTOR, y = n, fill = n)) +
coord_flip()
exped.data |> count(TERMREASON_FACTOR, sort=TRUE) |>
ggplot(aes(x = reorder(TERMREASON_FACTOR,n), y = n, fill = n)) +
coord_flip()
exped.data |> count(TERMREASON_FACTOR, sort=TRUE) |>
ggplot(aes(x = reorder(TERMREASON_FACTOR,n), y = n, fill = n)) +
geom_col() +
coord_flip()
?geom_col
exped.data |> count(TERMREASON_FACTOR, sort=TRUE) |>
ggplot(aes(x = reorder(TERMREASON_FACTOR,n), y = n, fill = n)) +
geom_col(show.legend = TRUE) +
coord_flip()
coord_flip()
exped.data |> count(TERMREASON_FACTOR, sort=TRUE) |>
ggplot(aes(x = reorder(TERMREASON_FACTOR,n), y = n, fill = n)) +
geom_col() + geom_text(aes(label = n)) +
coord_flip()
exped.data |> count(TERMREASON_FACTOR, sort=TRUE) |>
ggplot(aes(x = reorder(TERMREASON_FACTOR,n), y = n, fill = n)) +
geom_col() + geom_text(aes(label = n, hjust = 1)) +
coord_flip()
exped.data |> count(TERMREASON_FACTOR, sort=TRUE) |>
ggplot(aes(x = reorder(TERMREASON_FACTOR,n), y = n, fill = n)) +
geom_col() + geom_text(aes(label = n, hjust = -1)) +
coord_flip()
exped.data |> count(TERMREASON_FACTOR, sort=TRUE) |>
ggplot(aes(x = reorder(TERMREASON_FACTOR,n), y = n, fill = n)) +
geom_col() + geom_text(aes(label = n, hjust = -0.5)) +
coord_flip()
exped.data |> count(TERMREASON_FACTOR, sort=TRUE) |>
ggplot(aes(x = reorder(TERMREASON_FACTOR,n), y = n, fill = n)) +
geom_col() + geom_text(aes(label = n, hjust = -0.5)) +
coord_flip() +
theme_cowplot()
exped.data |> count(TERMREASON_FACTOR, sort=TRUE) |>
ggplot(aes(x = reorder(TERMREASON_FACTOR,n), y = n, fill = n)) +
geom_col() + geom_text(aes(label = n, hjust = -0.5)) +
coord_flip() +
theme_minimal()
exped.data |> count(TERMREASON_FACTOR, sort=TRUE) |>
ggplot(aes(x = reorder(TERMREASON_FACTOR,n), y = n, fill = n)) +
geom_col() + geom_text(aes(label = n, hjust = -0.5)) +
coord_flip() +
labs(
title = "Common reasons for expedition termination",
x = "Number",
y = "Reasons"
)
library(tidyverse)
exped.data |> mutate(
success = SUCCESS1 | SUCCESS2 | SUCCESS3 | SUCCESS4,
death = MDEATHS + HDEATHS) |>
filter(!is.na(TOTDAYS), !is.na(success)) |>
ggplot(aes(xj = TOTDAYS, y = success, fill = success)) +
geom_point(color = "darkred") +
labs(
title = "Expedition Duration vs. Total Deaths",
x = "Total Days",
y = "Number of Deaths"
) +
theme_minimal()
exped.data |> mutate(
success = SUCCESS1 | SUCCESS2 | SUCCESS3 | SUCCESS4,
death = MDEATHS + HDEATHS) |>
filter(!is.na(TOTDAYS), !is.na(success)) |>
ggplot(aes(x = TOTDAYS, y = success, fill = success)) +
geom_point(color = "darkred") +
labs(
title = "Expedition Duration vs. Total Deaths",
x = "Total Days",
y = "Number of Deaths"
) +
theme_minimal()
exped.data |> mutate(
success = SUCCESS1 | SUCCESS2 | SUCCESS3 | SUCCESS4,
death = MDEATHS + HDEATHS) |>
filter(!is.na(TOTDAYS), !is.na(success)) |>
ggplot(aes(x = success, y = TOTDAYS, fill = success)) +
geom_point(color = "darkred") +
labs(
title = "Expedition Duration vs. Total Deaths",
x = "Total Days",
y = "Number of Deaths"
) +
theme_minimal()
exped.data |> mutate(
success = SUCCESS1 | SUCCESS2 | SUCCESS3 | SUCCESS4,
death = MDEATHS + HDEATHS) |>
filter(!is.na(TOTDAYS), !is.na(success)) |>
ggplot(aes(x = success, y = TOTDAYS, fill = success)) +
geom_boxplot() +
labs(
title = "Expedition Duration by Success",
x = "Success",
y = "Total Days"
) +
theme_minimal()
exped.data |> mutate(
success = SUCCESS1 | SUCCESS2 | SUCCESS3 | SUCCESS4,
death = MDEATHS + HDEATHS) |>
filter(!is.na(TOTDAYS), !is.na(success)) |>
ggplot(aes(x = success, y = TOTDAYS, fill = success)) +
geom_jitter() +
labs(
title = "Expedition Duration by Success",
x = "Success",
y = "Total Days"
) +
theme_minimal()
exped.data |> mutate(
success = SUCCESS1 | SUCCESS2 | SUCCESS3 | SUCCESS4,
death = MDEATHS + HDEATHS) |>
filter(!is.na(TOTDAYS), !is.na(success)) |>
ggplot(aes(x = success, y = TOTDAYS, fill = success)) +
geom_boxplot() +
labs(
title = "Expedition Duration by Success",
x = "Success",
y = "Total Days"
) +
theme_minimal()
a1 = exped.data |>
mutate(success = SUCCESS1 | SUCCESS2 | SUCCESS3 | SUCCESS4) |>
filter(!is.na(TOTDAYS), !is.na(success)) |>
ggplot(aes(x = success, y = TOTDAYS, fill = success)) +
geom_boxplot() +
labs(
title = "Expedition Duration by Success",
x = "Success",
y = "Total Days"
) +
theme_minimal()
a1
a2 = exped.data |>
mutate(death = MDEATHS + HDEATHS) |>
filter(!is.na(TOTDAYS), !is.na(death)) |>
ggplot(aes(x = death, y = TOTDAYS, fill = success)) +
geom_boxplot() +
labs(
title = "Expedition Duration and Fatality",
x = "Death",
y = "Total Days"
) +
theme_minimal()
a2
a2 = exped.data |>
mutate(death = MDEATHS + HDEATHS) |>
filter(!is.na(TOTDAYS), !is.na(death)) |>
ggplot(aes(x = death, y = TOTDAYS, fill = death)) +
geom_boxplot() +
labs(
title = "Expedition Duration and Fatality",
x = "Death",
y = "Total Days"
) +
theme_minimal()
a2
library(taylor)
taylor = taylor_album_songs
ggplot(taylor, aes(x=loudness, y=energy)) + geom_point(size=3)
library(tidyverse)
ggplot(taylor, aes(x=loudness, y=energy)) + geom_point(size=3)
ggplot(taylor, aes(x=acousticness, y=energy)) + geom_point(size=3)
peak_8k_names
View(peak.data)
unique(peak.data$PKNAME)
peak_8k = peak.data |> filter(HEIGHTM >= 8000) |> pull(PKNAME)
peak_8k
peak.data |> filter(HEIGHTM >= 8000) |> pull(PKNAME)
?labs
exped.data %>%
filter(PEAKID %in% (peak.data %>% filter(HEIGHTM >= 8000) %>% pull(PEAKID))) %>%
mutate(success = SUCCESS1 | SUCCESS2 | SUCCESS3 | SUCCESS4) %>%
group_by(NATION, O2USED) %>%
summarise(success_rate = mean(success, na.rm = TRUE), n = n()) %>%
filter(n >= 10) %>%
ggplot(aes(x = reorder(NATION, success_rate), y = success_rate, fill = O2USED)) +
geom_col(position = "dodge") +
coord_flip() +
labs(title = "Success Rate by Nation and Oxygen Use on 8000m Peaks",
y = "Success Rate", x = "Nation") +
scale_y_continuous(labels = scales::percent_format())
exped.data %>%
mutate(success = SUCCESS1 | SUCCESS2 | SUCCESS3 | SUCCESS4,
deaths = MDEATHS + HDEATHS) %>%
group_by(COMRTE) %>%
summarise(success_rate = mean(success, na.rm = TRUE),
fatality_rate = mean(deaths > 0, na.rm = TRUE),
n = n()) %>%
pivot_longer(cols = c(success_rate, fatality_rate), names_to = "metric", values_to = "rate") %>%
ggplot(aes(x = COMRTE, y = rate, fill = metric)) +
geom_col(position = "dodge") +
labs(title = "Success vs. Fatality Rates: Commercial vs. Non-Commercial",
x = "Commercial Expedition?", y = "Rate") +
scale_y_continuous(labels = scales::percent_format())
exped.data %>%
filter(!is.na(SMTDAYS), !is.na(SEASON_FACTOR)) %>%
ggplot(aes(x = SEASON_FACTOR, y = SMTDAYS, fill = O2USED)) +
geom_boxplot() +
labs(title = "Time to Summit by Season and Oxygen Use",
x = "Season", y = "Days to Summit") +
theme_minimal()
exped.data %>%
group_by(PEAKID) %>%
summarise(member_deaths = sum(MDEATHS, na.rm = TRUE),
expeditions = n(),
fatality_rate = member_deaths / expeditions) %>%
filter(expeditions >= 10) %>%
left_join(peak.data, by = "PEAKID") %>%
arrange(desc(fatality_rate)) %>%
ggplot(aes(x = reorder(PEAKNAME, fatality_rate), y = fatality_rate)) +
geom_col(fill = "darkred") +
coord_flip() +
labs(title = "Peaks with Highest Member Fatality Rate",
x = "Peak", y = "Fatality Rate") +
scale_y_continuous(labels = scales::percent_format())
exped.data %>%
group_by(PEAKID) %>%
summarise(member_deaths = sum(MDEATHS, na.rm = TRUE),
expeditions = n(),
fatality_rate = member_deaths / expeditions) %>%
filter(expeditions >= 10) %>%
left_join(peak.data, by = "PEAKID") %>%
arrange(desc(fatality_rate)) %>%
ggplot(aes(x = reorder(PKNAME, fatality_rate), y = fatality_rate)) +
geom_col(fill = "darkred") +
coord_flip() +
labs(title = "Peaks with Highest Member Fatality Rate",
x = "Peak", y = "Fatality Rate") +
scale_y_continuous(labels = scales::percent_format())
exped.data %>%
filter(!is.na(TOTDAYS), YEAR >= 1950) %>%
mutate(decade = (as.integer(as.character(YEAR)) %/% 10) * 10) %>%
group_by(decade) %>%
summarise(avg_days = mean(TOTDAYS, na.rm = TRUE)) %>%
ggplot(aes(x = factor(decade), y = avg_days)) +
geom_col(fill = "steelblue") +
labs(title = "Average Expedition Duration Over Decades",
x = "Decade", y = "Average Total Days") +
theme_minimal()
exped.data %>%
mutate(success = SUCCESS1 | SUCCESS2 | SUCCESS3 | SUCCESS4,
deaths = MDEATHS + HDEATHS) %>%
group_by(O2USED) %>%
summarise(success_rate = mean(success, na.rm = TRUE),
death_rate = mean(deaths > 0, na.rm = TRUE)) %>%
pivot_longer(cols = c(success_rate, death_rate), names_to = "metric", values_to = "rate") %>%
ggplot(aes(x = O2USED, y = rate, fill = metric)) +
geom_col(position = "dodge") +
scale_y_continuous(labels = scales::percent) +
labs(title = "Impact of Oxygen Use on Success and Deaths",
x = "Oxygen Used", y = "Rate")
hardest.peak = exped.data |>
mutate(success = SUCCESS1 | SUCCESS2 | SUCCESS3 | SUCCESS4) |>
group_by(PEAKID) |>
summarise(
attempts = n(),
successes = sum(success, na.rm = TRUE),
summit.rate = successes / attempts) |>
left_join(select(peak.data, PEAKID, PKNAME), by = "PEAKID") |>
arrange(summit.rate) |>
ggplot(aes(x = reorder(PKNAME, summit.rate), y = summit.rate)) +
geom_col(fill = "darkred") +
geom_text(aes(label = scales::percent(summit_rate, accuracy = 0.1)), hjust = -0.1) +
coord_flip() +
labs(
title = "Top 10 Hardest Peaks to Summit",
subtitle = "Peaks with most attempts but lowest summit success rate",
x = "Peak Name",
y = "Summit Success Rate"
) +
theme_minimal()
hardest.peak
exped.data |>
mutate(success = SUCCESS1 | SUCCESS2 | SUCCESS3 | SUCCESS4) |>
group_by(PEAKID) |>
summarise(
attempts = n(),
successes = sum(success, na.rm = TRUE),
summit.rate = successes / attempts) |>
left_join(select(peak.data, PEAKID, PKNAME), by = "PEAKID") |>
arrange(summit.rate) |>
ggplot(aes(x = reorder(PKNAME, summit.rate), y = summit.rate)) +
geom_col(fill = "darkred") +
geom_text(aes(label = scales::percent(summit.rate, accuracy = 0.1)), hjust = -0.1) +
coord_flip() +
labs(
title = "Top 10 Hardest Peaks to Summit",
subtitle = "Peaks with most attempts but lowest summit success rate",
x = "Peak Name",
y = "Summit Success Rate"
) +
theme_minimal()
exped.data |>
mutate(success = SUCCESS1 | SUCCESS2 | SUCCESS3 | SUCCESS4) |>
group_by(PEAKID) |>
summarise(
attempts = n(),
successes = sum(success, na.rm = TRUE),
summit.rate = successes / attempts) |>
left_join(select(peak.data, PEAKID, PKNAME), by = "PEAKID") |>
arrange(summit.rate) |>
ggplot(aes(x = reorder(PKNAME, summit.rate), y = summit.rate)) +
geom_col(fill = "darkred") +
geom_text(aes(label = scales::percent(summit.rate, accuracy = 0.1)), hjust = -0.1) +
coord_flip() +
labs(
title = "Top 10 Hardest Peaks to Summit",
subtitle = "Peaks with most attempts but lowest summit success rate",
x = "Peak Name",
y = "Summit Success Rate"
) +
theme_minimal()
exped.data |>
mutate(success = SUCCESS1 | SUCCESS2 | SUCCESS3 | SUCCESS4) |>
group_by(PEAKID) |>
summarise(
attempts = n(),
successes = sum(success, na.rm = TRUE),
summit.rate = successes / attempts) |>
left_join(select(peak.data, PEAKID, PKNAME), by = "PEAKID") |>
arrange(summit.rate) |>
slice_head(n = 10) |>
ggplot(aes(x = reorder(PKNAME, summit.rate), y = summit.rate)) +
geom_col(fill = "darkred") +
#geom_text(aes(label = scales::percent(summit.rate, accuracy = 0.1)), hjust = -0.1) +
coord_flip() +
labs(
title = "Top 10 Hardest Peaks to Summit",
subtitle = "Peaks with most attempts but lowest summit success rate",
x = "Peak Name",
y = "Summit Success Rate"
) +
theme_minimal()
exped.data |>
mutate(success = SUCCESS1 | SUCCESS2 | SUCCESS3 | SUCCESS4) |>
group_by(PEAKID) |>
summarise(
attempts = n(),
successes = sum(success, na.rm = TRUE),
summit.rate = successes / attempts) |>
left_join(select(peak.data, PEAKID, PKNAME), by = "PEAKID") |>
arrange(summit.rate) |>
slice_head(n = 10) |>
ggplot(aes(x = reorder(PKNAME, summit.rate), y = summit.rate)) +
geom_col(fill = "darkred") +
#geom_text(aes(label = scales::percent(summit.rate, accuracy = 0.1)), hjust = -0.1) +
coord_flip() +
labs(
title = "Top 10 Hardest Peaks to Summit",
subtitle = "Peaks with most attempts but lowest summit success rate",
x = "Peak Name",
y = "Summit Success Rate"
) +
theme_minimal()
#| output: console
exped.data |>
mutate(success = SUCCESS1 | SUCCESS2 | SUCCESS3 | SUCCESS4) |>
group_by(PEAKID) |>
summarise(
attempts = n(),
successes = sum(success, na.rm = TRUE),
summit.rate = successes / attempts) |>
left_join(select(peak.data, PEAKID, PKNAME), by = "PEAKID") |>
arrange(summit.rate) |>
slice_head(n = 10) |>
ggplot(aes(x = reorder(PKNAME, summit.rate), y = summit.rate)) +
geom_col(fill = "darkred") +
#geom_text(aes(label = scales::percent(summit.rate, accuracy = 0.1)), hjust = -0.1) +
coord_flip() +
labs(
title = "Top 10 Hardest Peaks to Summit",
subtitle = "Peaks with most attempts but lowest summit success rate",
x = "Peak Name",
y = "Summit Success Rate"
) +
theme_minimal()
#| chunk_output_type: console
exped.data |>
mutate(success = SUCCESS1 | SUCCESS2 | SUCCESS3 | SUCCESS4) |>
group_by(PEAKID) |>
summarise(
attempts = n(),
successes = sum(success, na.rm = TRUE),
summit.rate = successes / attempts) |>
left_join(select(peak.data, PEAKID, PKNAME), by = "PEAKID") |>
arrange(summit.rate) |>
slice_head(n = 10) |>
ggplot(aes(x = reorder(PKNAME, summit.rate), y = summit.rate)) +
geom_col(fill = "darkred") +
#geom_text(aes(label = scales::percent(summit.rate, accuracy = 0.1)), hjust = -0.1) +
coord_flip() +
labs(
title = "Top 10 Hardest Peaks to Summit",
subtitle = "Peaks with most attempts but lowest summit success rate",
x = "Peak Name",
y = "Summit Success Rate"
) +
theme_minimal()
exped.data |>
mutate(success = SUCCESS1 | SUCCESS2 | SUCCESS3 | SUCCESS4) |>
group_by(PEAKID) |>
summarise(
attempts = n(),
successes = sum(success, na.rm = TRUE),
summit.rate = successes / attempts) |>
left_join(select(peak.data, PEAKID, PKNAME), by = "PEAKID") |>
arrange(summit.rate) |>
slice_head(n = 10) |>
ggplot(aes(x = reorder(PKNAME, summit.rate), y = summit.rate)) +
geom_col(fill = "darkred") +
#geom_text(aes(label = scales::percent(summit.rate, accuracy = 0.1)), hjust = -0.1) +
coord_flip() +
labs(
title = "Top 10 Hardest Peaks to Summit",
subtitle = "Peaks with most attempts but lowest summit success rate",
x = "Peak Name",
y = "Summit Success Rate"
) +
theme_minimal()
exped.data |>
mutate(success = SUCCESS1 | SUCCESS2 | SUCCESS3 | SUCCESS4) |>
group_by(PEAKID) |>
summarise(
attempts = n(),
successes = sum(success, na.rm = TRUE),
summit.rate = successes / attempts) |>
left_join(select(peak.data, PEAKID, PKNAME), by = "PEAKID") |>
filter(!is.na(NAME), attempts >= 10) |>
arrange(summit.rate) |>
slice_head(n = 10) |>
ggplot(aes(x = reorder(PKNAME, summit.rate), y = summit.rate)) +
geom_col(fill = "darkred") +
#geom_text(aes(label = scales::percent(summit.rate, accuracy = 0.1)), hjust = -0.1) +
coord_flip() +
labs(
title = "Top 10 Hardest Peaks to Summit",
subtitle = "Peaks with most attempts but lowest summit success rate",
x = "Peak Name",
y = "Summit Success Rate"
) +
theme_minimal()
exped.data |>
mutate(success = SUCCESS1 | SUCCESS2 | SUCCESS3 | SUCCESS4) |>
group_by(PEAKID) |>
summarise(
attempts = n(),
successes = sum(success, na.rm = TRUE),
summit.rate = successes / attempts) |>
left_join(select(peak.data, PEAKID, PKNAME), by = "PEAKID") |>
filter(!is.na(PKNAME), attempts >= 10) |>
arrange(summit.rate) |>
slice_head(n = 10) |>
ggplot(aes(x = reorder(PKNAME, summit.rate), y = summit.rate)) +
geom_col(fill = "darkred") +
#geom_text(aes(label = scales::percent(summit.rate, accuracy = 0.1)), hjust = -0.1) +
coord_flip() +
labs(
title = "Top 10 Hardest Peaks to Summit",
subtitle = "Peaks with most attempts but lowest summit success rate",
x = "Peak Name",
y = "Summit Success Rate"
) +
theme_minimal()
exped.data |> mutate(success = SUCCESS1 | SUCCESS2 | SUCCESS3 | SUCCESS4) |>
group_by(O2USED) |>
summarise(success.rate = (mean(success, na.rm = TRUE))) |>
ggplot(aes(x = O2USED, y = success.rate, fill = O2USED)) +
geom_col(width = 0.3) +
geom_text(aes(label = scales::percent(success.rate, accuracy = 0.1), vjust = -0.5,  size = 4)
) +
theme(legend.position = "none") +
labs(
title = "Success rate with supplemental oxygen",
x = "Oxygen used",
y = "Success rate")
